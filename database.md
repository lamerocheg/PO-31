# Базы данных

-----

## Назначение СУБД(Систем управления базами данных)

Основная идея это хранение на внешнем носителе не только самих данных , но и описание их структур.

![alt text](http://i.imgur.com/lnG78pB.png "классическое взаимодействие с файлами")

![alt text](http://i.imgur.com/TkRCf0J.png "взаимодействие программ с файлами при помощи субд")

#### достоинства использования СУБД :

1. снижение сетевого трафика.
2. возможность создания программ независимых от структуры хранения данных на внешнем устройстве.
3. возможность использования стандартных качественно реализованных СУБД алгоритмов обработки данных(сортировка, поиск, ведение индексов и т. д.)
4. автоматическое поддержание целостности данных. Авто резервное копирование, откат транзакций и др.
5. разграничение доступа к данным за счет авторизации пользователя и установки уровня по умолчанию
6. автоматизация отображения данных

---

## Иерархическая и сетевая модель данных

СУБД различаются способом представления связей между объектами(моделями данных) 

1. иерархическая
2. сетевая
3. реляционная
4. пост-реляционная
 
Исторически первой была система IMS  производства IBM  ее украли и назвали OKA. В ней 1 объект является главным а остальные подчиненные на разных уровнях иерархии.
недостаток : реальные объекты не всегда находятся в строгой иерархической зависимости. 
В сетевых базах любой объект может быть как главным так и подчиненным ADABAS ее украли и назвали ADABAC. Основной недостаток -  это инструмент для программистов.
В начале 70-х Кодд предложил реляционную модель СУБД.

-

## Реляционная модель СУБД.

Кодд стремился упростить структуру базы.
В традиционных реляционных СУБД данные хранятся в таблицах. Таблица соответствует типу объекта. Строка таблицы это экземпляр объекта. Столбец — значения атрибута в экземплярах. Имена таблиц уникальны в базе. Имена столбцов уникальны в таблице. Таблица может иметь произвольное количество строк. Возможно — ни одной. Строки таблицы не упорядочены. Нет понятия 1 строка или последняя. Каждая таблица содержит поле или совокупность полей однозначно определяющих запись это поле или совокупность называется первичный ключ. Поле или совокупность полей значение которых совпадают со значением первичного ключа одной из записей в другой таблице называются внешним ключом совокупность внешнего и первичного ключа определяют связь между объектами таблица с первичным ключом родительская , таблица с внешним ключом дочерняя. 

-

## Проектирование баз данных

#### этапы :

1. определение состава объектов
2. определение связи между объектами 
3. определение атибутов объектов 
4. нормализация отношений 

Предположим что база данных об учебном процессе. объекты будут `факультет` , `кафедра` , `преподаватель` , `группа` , `студент`

есть три типа связи. 
1. 1 к 1 :одному экземпляру первого типа соответствует 1 экземпляр второго типа (<--->). хотя такое возможно но встречается редко и вообще быть не должно. есть 2 причины почему одну таблицу можно разделить : производительность и упрощение администрирования. 
2. 1 к многим : 1 экземпляру объекта первого типа соответствует много экземплярова объектов второго типа (<--->->) .
3. многие ко многим : одному обекту первого тип могут соответствовать многие и наоборот. такх связей не существует . если реально такая связ есть то проблема решается добавленем еще одного типа объекта. дочернего по отношению к ним.

####Определение состава атрибутов объекта

1. поля первичного ключа
2. поля внешних ключей в дочерних таблицах
3. не ключевые атрибуты

####Нормализация отношений 

нормализация отношений это процесс выбора оптимального состава объектов. 

Пусть сведения о нагрузке представлены в таблице нагрузка преподавателя

####1НФ

Говорят что отношения находятся в первой нормальной форме если значения каждого атрибута неделимо.

Недостатки :
1. проблема реализации обновления данных(нельзя добавить преподавателя не имеющего нагрузки)
2. при удалении нагрузки теряются сведения о преподавателе
3. изменения значения атрибутов требуют просмотра всей таблицы 

####2НФ

отношения в первой нормальной форме и каждый неключевой атрибут полностью зависит от всех атрибутов первичного ключа

переход к 2НФ разделением отношения на несколько

есть недостатки :

1. нельзя добавить кафедру не указав преподавателя
2. при удалении преподавателей теряются ведения о кафедрах
3. изменение зависимости кафедра-факультет требует просмотра всего отношения 

####3НФ

Говорят что отношения в третьей нормалной форме если она во второй и каждый неключевой атрибут нетранзитивно зависит от ключа

преобразование путем разделения отношений 

достоинством нормализации является устранение избыточности данных. 

### дополниельные рекомедации по проектированию :

1. не нужно включать в базу атрибут значение которого может быть расчитано по другим атрибутам. т.к. тогда значние нового атрибута придется пересчитывать при изменении исходных данных. <триггер>
2. при наличии повторяющегося значения атрибута в таблице обычно выгодно создать дополнительную таблиу-справочник в формате код-значение. значение атрибут может мняться во времени и код решает проблему. при наличии справочника в приожениях можно выполнять не ввод значения а выбор из списка.

-

## Создание базы данных

теперь надо создать реальную базу данных. описать атблицы поля и связи. изначально в MS Acces. В любой СУБД есть визуальные средства для определения визуальной структуры базы данных. когда созаем пустую базу данных. потом можем создавать таблицы появляется форма где можно вводить имена полей и указывать их типы. 
#### Типы данных(полей)
######MS Access
* текстовое поле(250 символов/ можно указать длину)
* Memo(текстовое поле но длина до 2гб)

######MS SQL Server
* char, varchar(эквиваленты ткстового поля до 8192 символов)
* text(устаревает) , varchar(max) 
